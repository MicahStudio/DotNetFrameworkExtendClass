<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Dotnetframeworkextendclass by MicahStudio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Dotnetframeworkextendclass</h1>
      <h2 class="project-tagline">DotNet的一些扩展方法和常用的封装</h2>
      <a href="https://github.com/MicahStudio/DotNetFrameworkExtendClass" class="btn">View on GitHub</a>
      <a href="https://github.com/MicahStudio/DotNetFrameworkExtendClass/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/MicahStudio/DotNetFrameworkExtendClass/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="这是咋来的" class="anchor" href="#%E8%BF%99%E6%98%AF%E5%92%8B%E6%9D%A5%E7%9A%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>这是咋来的？</h3>

<p>这个项目中的方法都是在工作过程中遇到的一些重复操作进行的封装，扩展方法用起来很方便，但是会牺牲一点性能。不过在现在内存都足够的情况下，这点牺牲在我所参与的项目中都是可以接受的，而这些扩展方法也的确方便了项目的开发与维护。</p>

<h3>
<a id="systemstring" class="anchor" href="#systemstring" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.String</h3>

<ul>
<li>bool IsNullOrWhiteSpace()</li>
<li>string Append(string text)</li>
<li>byte[] ToBytes()</li>
<li>string ToMD5()</li>
<li>string Encrypt(string SecretKey, bool SingleLine = true, bool Standard = false)</li>
<li>string Decrypt(string SecretKey, bool SingleLine = true, bool Standard = false)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    <span class="pl-k">string</span> simple = <span class="pl-s"><span class="pl-pds">"</span>Hello world.<span class="pl-pds">"</span></span>;
    <span class="pl-k">if</span>(simple.IsNullOrWhiteSpace()){
        Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>空字符串。<span class="pl-pds">"</span></span>);
    }
    <span class="pl-k">string</span> newsimple = simple.Append(<span class="pl-s"><span class="pl-pds">"</span>Hello Github.<span class="pl-pds">"</span></span>);
    <span class="pl-k">var</span> buffer = newsimple.ToBytes();
    <span class="pl-k">string</span> md5string = newsimple.ToMD5();
    <span class="pl-k">string</span> en = newsimple.Encrypt(<span class="pl-s"><span class="pl-pds">"</span>密钥<span class="pl-pds">"</span></span>);
    <span class="pl-k">string</span> de = en.Decrypt(<span class="pl-s"><span class="pl-pds">"</span>密钥<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="systemrandom" class="anchor" href="#systemrandom" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.Random</h3>

<ul>
<li>string NextString(int Length = 6, bool AllowedRepeat = true)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    Random rand = <span class="pl-k">new</span> Random();
    <span class="pl-k">string</span> randstring1 = rand.NextString();
    <span class="pl-k">string</span> randstring2 = rand.NextString(<span class="pl-c1">10</span>);
    <span class="pl-k">string</span> randstring3 = rand.NextString(<span class="pl-c1">10</span>,<span class="pl-c1">true</span>);</pre></div>

<h3>
<a id="systemdatetime" class="anchor" href="#systemdatetime" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.DateTime</h3>

<ul>
<li>int WeekOfYear()</li>
<li>Int64 UnixTimestamp()</li>
<li>Int64 UnixTimestamp(DateTime datetime)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    DateTime datetime = DateTime.Now;
    <span class="pl-k">int</span> woy = datetime.WeekOfYear();
    <span class="pl-k">long</span> timestamp1 = datetime.UnixTimestamp();
    <span class="pl-k">long</span> timestamp2 = datetime.UnixTimestamp(<span class="pl-k">new</span> DateTime(<span class="pl-c1">2046</span>,<span class="pl-c1">10</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>,<span class="pl-c1">0</span>,<span class="pl-c1">0</span>));</pre></div>

<h3>
<a id="关于mef插件式的扩展" class="anchor" href="#%E5%85%B3%E4%BA%8Emef%E6%8F%92%E4%BB%B6%E5%BC%8F%E7%9A%84%E6%89%A9%E5%B1%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>关于MEF插件式的扩展</h3>

<p>此方法将载入插件的形式进行了封装，参数留空则插件目录默认为Lib，可以自己传入目录。</p>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">MEFTest</span>{
        <span class="pl-k">public</span> <span class="pl-en">MEFTest</span>(){
                <span class="pl-c1">this</span>.ComposePartsSelf();
                <span class="pl-c">//this.ComposePartsSelf("plugins");</span>
        }
    }</pre></div>

<h3>
<a id="systembyte" class="anchor" href="#systembyte" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.Byte</h3>

<ul>
<li>string Decrypt(string SecretKey, bool SingleLine = true, bool Standard = false)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    <span class="pl-k">byte</span>[] bytes = getEncryptBytes();
    <span class="pl-k">string</span> de = bytes.Decrypt(<span class="pl-s"><span class="pl-pds">"</span>密钥<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="systemnetnetworkinformationping" class="anchor" href="#systemnetnetworkinformationping" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.Net.NetworkInformation.Ping</h3>

<ul>
<li>bool IsWork(string IPAddress, int Timeout = 300)</li>
<li>PingReply Reply(string IPAddress, int Timeout = 300)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    Pint p = <span class="pl-k">new</span> Ping();
    <span class="pl-k">bool</span> isWork = p.IsWork(<span class="pl-s"><span class="pl-pds">"</span>192.168.0.1<span class="pl-pds">"</span></span>);
    PingReply pr = p.Reply(<span class="pl-s"><span class="pl-pds">"</span>192.168.0.1<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="systemlinqiqueryable" class="anchor" href="#systemlinqiqueryable" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.Linq.IQueryable</h3>

<ul>
<li>IQueryable Sorting(string OrderParameter, SortDirection OrderDirection)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    <span class="pl-k">var</span> items = items.Sorting(<span class="pl-s"><span class="pl-pds">"</span>要排序的字段名<span class="pl-pds">"</span></span>,SortDirection.OrderByDescending);</pre></div>

<h3>
<a id="systemdatasqlclientsqlcommand" class="anchor" href="#systemdatasqlclientsqlcommand" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.Data.SqlClient.SqlCommand</h3>

<ul>
<li>void AddParameters(string ParameterName, System.Data.SqlDbType SqlDbType, object Value)</li>
<li>void AddParameters(string ParameterName, object Value)</li>
<li>ObservableCollection GenericList()</li>
<li>T GenericObject()</li>
</ul>

<h3>
<a id="systemcollectionsobjectmodelobservablecollection" class="anchor" href="#systemcollectionsobjectmodelobservablecollection" aria-hidden="true"><span class="octicon octicon-link"></span></a>System.Collections.ObjectModel.ObservableCollection</h3>

<ul>
<li>int PageSize(int Number)</li>
<li>ObservableCollection PageCollection(int Number, int CurrentSize)</li>
</ul>

<h3>
<a id="dotnetframeworkextendclasswinrar" class="anchor" href="#dotnetframeworkextendclasswinrar" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.WinRAR</h3>

<p><strong><em>使用该类需要在客户端安装了WinRAR软件。</em></strong></p>

<ul>
<li>bool UnRar(string zipFilePath, string UnZipPath)</li>
</ul>

<p><strong>示例</strong></p>

<div class="highlight highlight-csharp"><pre>    WinRAR rar = <span class="pl-k">new</span> WinRAR();
    <span class="pl-k">bool</span> result = rar.UnRar(<span class="pl-s"><span class="pl-pds">@"C:\test.rar"</span></span>,<span class="pl-s"><span class="pl-pds">@"D:\unrar"</span></span>);    </pre></div>

<h3>
<a id="dotnetframeworkextendclasssingleton" class="anchor" href="#dotnetframeworkextendclasssingleton" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.Singleton</h3>

<p><strong><em>用反射模式实现单例模式的基类</em></strong></p>

<p><strong><em>示例</em></strong></p>

<div class="highlight highlight-csharp"><pre>    <span class="pl-k">public</span> <span class="pl-k">sealed</span> <span class="pl-k">class</span> <span class="pl-en">TestApp</span> : <span class="pl-k">Singleton</span>&lt;<span class="pl-k">TestApp</span>&gt;{
        <span class="pl-k">private</span> <span class="pl-en">TestApp</span>(){}
        <span class="pl-c">//********//</span>
    }
    <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Program</span>{
        <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">Main</span>(){
           TestApp ta = TestApp.Instance;
        }
    }</pre></div>

<h3>
<a id="dotnetframeworkextendclassiconfigurationmanager" class="anchor" href="#dotnetframeworkextendclassiconfigurationmanager" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.IConfigurationManager</h3>

<p><strong><em>该接口可以对应用程序配置文件app.config进行操作</em></strong></p>

<ul>
<li>IsSecret:是否对字段的值进行加密（默认为不加密）</li>
<li>SecretKey:加＼解密的Key（需要将IsSecret设置为Ture才会生效）</li>
<li>UpdateOnInsert(ConfigurationManagerSectionType SectionType, string Key, string Value)</li>
<li>string GetValue(ConfigurationManagerSectionType SectionType, string Key, string defaultValue = "")</li>
</ul>

<h3>
<a id="dotnetframeworkextendclassgenerationbitmapverificationcode" class="anchor" href="#dotnetframeworkextendclassgenerationbitmapverificationcode" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.GenerationBitmapVerificationCode</h3>

<ul>
<li>Image Out(Color FontColor, Color BackgroundColor, int Width = 200, int Height = 75, float FontSize = 13, string Code = "", int Length = 4)</li>
</ul>

<p><strong><em>示例</em></strong></p>

<div class="highlight highlight-csharp"><pre>    GenerationBitmapVerificationCode code = GenerationBitmapVerificationCode.Instance;
    Image bmp = code.Out(Color.White,Color.Black);</pre></div>

<h3>
<a id="dotnetframeworkextendclassemailhelper" class="anchor" href="#dotnetframeworkextendclassemailhelper" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.EmailHelper</h3>

<ul>
<li>void ForNetease(string Form, string UserID, string Password, string To, string Title, string Content, System.Net.Mail.MailPriority Priority = System.Net.Mail.MailPriority.High)</li>
<li>void ForCustom(string Form, string Smtp, int SmtpPort, string UserID, string Password, string To, string Title, string Content, System.Net.Mail.MailPriority Priority = System.Net.Mail.MailPriority.High)</li>
</ul>

<p><strong><em>示例</em></strong></p>

<div class="highlight highlight-csharp"><pre>    EmailHelper email = EmailHelper.Instance;
    email.ForNetease(<span class="pl-s"><span class="pl-pds">"</span>admin@163.com<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>admin<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>adminpassword<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>client@qq.com<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>邮件标题<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>邮件正文内容。<span class="pl-pds">"</span></span>);
    email.ForCustom(<span class="pl-s"><span class="pl-pds">"</span>admin@qq.com<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>smtp.qq.com<span class="pl-pds">"</span></span>,<span class="pl-c1">443</span>,<span class="pl-s"><span class="pl-pds">"</span>admin<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>adminpassword<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>client@qq.com<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>邮件标题<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>邮件正文内容。<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="dotnetframeworkextendclassexeconfigcontext" class="anchor" href="#dotnetframeworkextendclassexeconfigcontext" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.ExeConfigContext</h3>

<p><strong><em>单例模式对exe.config进行操作</em></strong></p>

<ul>
<li>void SetConnectionString(string name, string connectionString)</li>
<li>string GetConnectionString(string name)</li>
<li>void SetValue(string name, T value) where T : struct</li>
<li>string GetValue(string name)</li>
<li>T GetValue(string name) where T : struct</li>
</ul>

<p><strong><em>示例</em></strong></p>

<div class="highlight highlight-csharp"><pre>    ExeConfigContext config = ExeConfigContext.Instance;
    config.SetConnectionString(<span class="pl-s"><span class="pl-pds">"</span>DBConnection<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Server=.;Database=mydbs;User Id=sa;Password=sa;<span class="pl-pds">"</span></span>)
    <span class="pl-k">string</span> connectionString = config.GetConnectionString(<span class="pl-s"><span class="pl-pds">"</span>DBConnection<span class="pl-pds">"</span></span>);
    config.SetValue&lt;<span class="pl-k">bool</span>&gt;(<span class="pl-s"><span class="pl-pds">"</span>Status<span class="pl-pds">"</span></span>,<span class="pl-c1">true</span>);
    <span class="pl-k">string</span> value1 = config.GetValue(<span class="pl-s"><span class="pl-pds">"</span>Status<span class="pl-pds">"</span></span>);
    <span class="pl-k">bool</span> value2 = config.GetValue&lt;<span class="pl-k">bool</span>&gt;(<span class="pl-s"><span class="pl-pds">"</span>Status<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="dotnetframeworkextendclassapplicationprocess" class="anchor" href="#dotnetframeworkextendclassapplicationprocess" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.ApplicationProcess</h3>

<ul>
<li>string[] ProcessNames()</li>
<li>bool FindProcessExist(string ProcessName)</li>
</ul>

<h3>
<a id="dotnetframeworkextendclassfilehelper" class="anchor" href="#dotnetframeworkextendclassfilehelper" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.FileHelper</h3>

<ul>
<li>string GetMD5Hash(string FileName, string Separator = "", bool Upper = true)</li>
</ul>

<h3>
<a id="dotnetframeworkextendclassperformanceobservation" class="anchor" href="#dotnetframeworkextendclassperformanceobservation" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.PerformanceObservation</h3>

<p><strong><em>单例模式</em></strong></p>

<ul>
<li>void TotalMemoryBegin()</li>
<li>void TotalMemoryEnd()</li>
<li>UseMemory:计算内存消耗量(Kb)</li>
<li>void BeginTime()</li>
<li>void EndTime()</li>
<li>Useup:计算消耗时间（毫秒）</li>
</ul>

<p><strong><em>示例</em></strong></p>

<div class="highlight highlight-csharp"><pre>    PerformanceObservation po= PerformanceObservation.Instance;
    po.TotalMemoryBegin()
    <span class="pl-c">///消耗内存的操作</span>
    po.TotalMemoryEnd()
    Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>内存消耗：{0}(kb)<span class="pl-pds">"</span></span>,po.UseMemory);
    po.BeginTime()
    <span class="pl-c">///耗时操作</span>
    po.EndTime()
    Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>耗时：{0}(ms)<span class="pl-pds">"</span></span>,po.Useup);</pre></div>

<h3>
<a id="dotnetframeworkextendclassscheduledtasks" class="anchor" href="#dotnetframeworkextendclassscheduledtasks" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.ScheduledTasks</h3>

<p><strong><em>添加Windows计划任务静态类</em></strong></p>

<ul>
<li>void CreateTask(string TaskName, int Minute, string FullPath)</li>
<li>void DeleteTask(string TaskName)</li>
</ul>

<h3>
<a id="dotnetframeworkextendclassmessagingmessenger" class="anchor" href="#dotnetframeworkextendclassmessagingmessenger" aria-hidden="true"><span class="octicon octicon-link"></span></a>DotNetFrameworkExtendClass.Messaging.Messenger</h3>

<p><strong><em>来自于MVVM源码</em></strong></p>

<p><strong><em>示例</em></strong></p>

<div class="highlight highlight-csharp"><pre>    Messenger.Default.Register&lt;T&gt;(<span class="pl-s"><span class="pl-pds">"</span>Token<span class="pl-pds">"</span></span>,(sender)=&gt;{ });
    Messenger.Default.Send&lt;T&gt;(<span class="pl-k">new</span> Object{},<span class="pl-s"><span class="pl-pds">"</span>Token<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="关于我" class="anchor" href="#%E5%85%B3%E4%BA%8E%E6%88%91" aria-hidden="true"><span class="octicon octicon-link"></span></a>关于我</h3>

<ul>
<li>程序猿</li>
<li>参与过政府类项目、民生类项目、以及商业项目</li>
<li>人手不够的时候我自己完成过一个项目（简直难以忍受= =|||）</li>
</ul>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Having trouble with Pages? Check out our <a href="https://help.github.com/pages">documentation</a> or <a href="https://github.com/contact">contact support</a> and we’ll help you sort it out.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/MicahStudio/DotNetFrameworkExtendClass">Dotnetframeworkextendclass</a> is maintained by <a href="https://github.com/MicahStudio">MicahStudio</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
